# ูุฎุชุจุฑ ุฃูุงู JWT - JWT Authentication Security Lab

ูุฐุง ุงููุดุฑูุน ููุถุญ ุงููุฑู ุจูู ุชุทุจูู JWT ุขูู ูุขุฎุฑ ุถุนููุ ููุธูุฑ ุงูุซุบุฑุงุช ุงูุฃูููุฉ ุงูุดุงุฆุนุฉ ูู JWT ูููููุฉ ุญูุงูุชูุง.

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ
- Node.js (ุงูุฅุตุฏุงุฑ 14 ุฃู ุฃุญุฏุซ)
- npm
- Wireshark (ูุชุญููู ุญุฑูุฉ ุงููุฑูุฑ)

### ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

1. **ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ:**
   ```bash
   npm install
   ```

2. **ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ:**
   ```bash
   # ุงูุณุฎ ููู ุงูุจูุฆุฉ
   cp .env.example .env
   
   # ูู ุจุชูููุฏ ุฃุณุฑุงุฑ ุขููุฉ
   node -e "console.log('ACCESS_SECRET=' + require('crypto').randomBytes(64).toString('hex')); console.log('REFRESH_SECRET=' + require('crypto').randomBytes(64).toString('hex'));"
   ```

3. **ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
   ```bash
   npm run init-db
   ```

4. **ุชุดุบูู ุงูุฎูุงุฏู:**
   ```bash
   # ุชุดุบูู ุงูุฎุงุฏู ุงูุถุนูู (ุงููููุฐ 1234)
   npm run start-vuln
   
   # ุชุดุบูู ุงูุฎุงุฏู ุงูุขูู (ุงููููุฐ 1235) 
   npm run start-secure
   
   # ุฃู ุชุดุบูู ุงูุฎุงุฏู ุงูุขูู ุงูุชุฑุงุถูุงู
   npm start
   ```

5. **ุงููุตูู ููุชุทุจูู:**
   - ุงูุฎุงุฏู ุงูุถุนูู: http://localhost:1234
   - ุงูุฎุงุฏู ุงูุขูู: http://localhost:1235

## ๐ ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

### ูุทููุจ: ุฅุนุฏุงุฏ ููู .env

**ููู ุฌุฏุงู:** ุงูุณุฎ ููู `.env.example` ุฅูู `.env` ููู ุจุชุนููู ุฌููุน ุงูุฃุณุฑุงุฑ:

```bash
# ุงูุณุฎ ุงููุงูุจ
cp .env.example .env

# ูู ุจุชูููุฏ ุฃุณุฑุงุฑ ุขููุฉ
node -e "console.log('ACCESS_SECRET=' + require('crypto').randomBytes(64).toString('hex')); console.log('REFRESH_SECRET=' + require('crypto').randomBytes(64).toString('hex'));"
```

### ุชูููุฏ ุงูุฃุณุฑุงุฑ

ุงุณุชุฎุฏู ูุญุฏุฉ crypto ูู Node.js ูุชูููุฏ ุฃุณุฑุงุฑ ุขููุฉ:

```javascript
// ุชูููุฏ ุฃุณุฑุงุฑ ุนุดูุงุฆูุฉ ุขููุฉ (64 ุจุงูุช = 128 ุญุฑู hex)
const crypto = require('crypto');
const accessSecret = crypto.randomBytes(64).toString('hex');
const refreshSecret = crypto.randomBytes(64).toString('hex');
```

## ๐ก๏ธ ุงูููุฒุงุช ุงูุฃูููุฉ

### ุงูุฎุงุฏู ุงูุขูู (ุงููููุฐ 1235)

#### โ ุงูุชุฏุงุจูุฑ ุงูุฃูููุฉ ุงููุทุจูุฉ

1. **ุงูุชูููู ุงููุงุฆู ุนูู ุงูุจูุฆุฉ**
   - ุฌููุน ุงูุฃุณุฑุงุฑ ูุญููุธุฉ ูู ููู `.env`
   - ูุง ุชูุฌุฏ ุจูุงูุงุช ุงุนุชูุงุฏ ูุจุฑูุฌุฉ ูู ุงูููุฏ ุงููุตุฏุฑู
   - ุงูุชุญูู ูู ุงูุจูุฆุฉ ุนูุฏ ุจุฏุก ุงูุชุดุบูู

2. **ูุทุงูุจุงุช ุงูุฑูุฒ ุงููููุฉ ูุงูุชุญูู**
   - **ุงููุตุฏุฑ (`iss`)**: `jwt-lab-secure`
   - **ุงูุฌูููุฑ (`aud`)**: `jwt-lab-client`
   - **ุงูุฎูุงุฑุฒููุฉ**: `HS256` ููุท ุจุดูู ุตุงุฑู
   - **ุงูุงูุชูุงุก**: 15 ุฏูููุฉ ูุฑููุฒ ุงููุตูู
   - **ุงูุชุญูู**: ุฌููุน ุงููุทุงูุจุงุช ูุชู ุงูุชุญูู ูููุง ูู ูู ุทูุจ

3. **ุงุณุชุฑุงุชูุฌูุฉ ุฑูุฒ ุงูุชุญุฏูุซ**
   - **ุฏูุฑุงู ุงูุฑูุฒ**: ุฑููุฒ ุงูุชุญุฏูุซ ุงููุฏููุฉ ุชูุจุทู ุนูุฏ ุงูุงุณุชุฎุฏุงู
   - **ุฃุณุฑุงุฑ ูููุตูุฉ**: ุฃุณุฑุงุฑ ูุฎุชููุฉ ุนู ุฑููุฒ ุงููุตูู
   - **ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท HttpOnly**: ุฑููุฒ ุงูุชุญุฏูุซ ุบูุฑ ูุงุจูุฉ ูููุตูู ุนุจุฑ JavaScript
   - **ุงูุชุฎุฒูู ุนูู ุงูุฎุงุฏู**: ูุนุฑูุงุช ุฑููุฒ ุงูุชุญุฏูุซ ูุชุชุจุนุฉ ูู ุงูุฐุงูุฑุฉ
   - **ุงูุจุญุซ ุนู ุงูุฏูุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**: ุฃุฏูุงุฑ ุงููุณุชุฎุฏููู ูุชู ุฌูุจูุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฑููุฒ ุงููุตูู ุงูุฌุฏูุฏุฉ

### ุงูุฎุงุฏู ุงูุถุนูู (ุงููููุฐ 1234)

#### โ๏ธ ุงูููุฒุงุช ุงูุถุนููุฉ ุนูุฏุงู

1. **ุณุฑ ุถุนูู**: `weak-secret-lab-only` (ุณูู ุงูุชุฎููู)
2. **ุงูุชูุงุก ุตูุงุญูุฉ ุทููู**: 7 ุฃูุงู ูุฑููุฒ ุงููุตูู
3. **ูุฌูู ุฎูุงุฑุฒููุฉ None**: ููุจู ุฑููุฒ `{"alg":"none"}`
4. **ุนุฏู ุงูุชุญูู ูู ุงููุทุงูุจุงุช**: ููููุฏ ุงูุชุญูู ูู ุงููุตุฏุฑ/ุงูุฌูููุฑ
5. **ุชุฎุฒูู localStorage**: ุงูุฑููุฒ ูุงุจูุฉ ูููุตูู ุนุจุฑ JavaScript

## ๐ฏ ุนุฑุถ ุงููุฌูุงุช

### ุงููุฌูู ุงูุฃูู: ูุฌูู ุฎูุงุฑุฒููุฉ None

**ุงููุฏู**: ุงูุฎุงุฏู ุงูุถุนูู (ุงููููุฐ 1234)

1. **ุงูุญุตูู ุนูู ุฑูุฒ ุตุงูุญ** ุจุชุณุฌูู ุงูุฏุฎูู ุจุดูู ุทุจูุนู
2. **ูู ุชุดููุฑ ุงูุฑูุฒ** ุจุงุณุชุฎุฏุงู ุฒุฑ "Whoami"
3. **ุชุนุฏูู ุงูุฑุฃุณ** ุฅูู `{"alg":"none"}`
4. **ุฅุฒุงูุฉ ุงูุชูููุน** (ุงูุฌุฒุก ุงูุซุงูุซ ูู JWT)
5. **ุฅุฑุณุงู ุงูุฑูุฒ ุงููุนุฏู** ุฅูู ููุทุฉ ุงูููุงูุฉ `/admin`

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ุงููุตูู ููููุญ ุจุงูุฑูุฒ ุงููุนุฏู

**ุงูุญูุงูุฉ**: ุงูุฎุงุฏู ุงูุขูู ูุฑูุถ ุฑููุฒ `alg: none`

### ุงููุฌูู ุงูุซุงูู: ุชุฒููุฑ ุงูุฑูุฒ ุจุงูุณุฑ ุงูุถุนูู

**ุงููุฏู**: ุงูุฎุงุฏู ุงูุถุนูู (ุงููููุฐ 1234)

1. **ุงุณุชุฎุฏุงู ุงูุณุฑ ุงูุถุนูู ุงููุนุฑูู**: `weak-secret-lab-only`
2. **ุฅูุดุงุก ุฑูุฒ ูุฒูุฑ** ุจุฏูุฑ ุงููุฏูุฑ
3. **ุฅุฑุณุงู ุงูุฑูุฒ ุงููุฒูุฑ** ุฅูู ููุทุฉ ุงูููุงูุฉ `/admin`

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**: ุงููุตูู ููููุญ ุจุงูุฑูุฒ ุงููุฒูุฑ

**ุงูุญูุงูุฉ**: ุงูุฎุงุฏู ุงูุขูู ูุณุชุฎุฏู ุฃุณุฑุงุฑ ูููุฉ ุชุดููุฑูุงู

## ๐งช ุฃูุงูุฑ ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงููุฌูุงุช

```bash
# ุชูููุฏ ุฑููุฒ ุงููุฌูู
node attack-demos.js

# ุนุฑุถ ุงูููุฎุต ุงููุงูู ููุฃูุงู
node security-demo.js
```

### ุงุฎุชุจุงุฑ API ูุฏููุงู

```bash
# ุชุณุฌูู ุงูุฏุฎูู ููุฎุงุฏู ุงูุขูู
curl -X POST http://localhost:1235/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"adminpass"}' \
  -c cookies.txt

# ุงููุตูู ูููุทุฉ ุงูููุงูุฉ ุงูุฅุฏุงุฑูุฉ
curl http://localhost:1235/admin \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -b cookies.txt
```

## ๐ ูููู ุงููุดุฑูุน

```
jwt/
โโโ .env.example           # ูุงูุจ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
โโโ .gitignore            # ูููุงุช ูุณุชุจุนุฏุฉ ูู Git
โโโ package.json          # ุงูููุชุจุงุช ูุงูุฃูุงูุฑ
โโโ init-db.js           # ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ secure-server.js     # ุฎุงุฏู JWT ูุญูู
โโโ vuln-server.js       # ุฎุงุฏู JWT ุถุนูู  
โโโ attack-demos.js      # ุณูุฑูุจุช ุนุฑุถ ุงููุฌูุงุช
โโโ security-demo.js     # ููุฎุต ุงูุฃูุงู ุงููุงูู
โโโ README.md            # ุงูุชูุซูู ุจุงูุฅูุฌููุฒูุฉ
โโโ README_AR.md         # ุงูุชูุซูู ุจุงูุนุฑุจูุฉ
โโโ public/              # ูููุงุช ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
    โโโ index.html       # ุงูุชุทุจูู ุงูุฑุฆูุณู
    โโโ script.js        # JavaScript ูู ุฌุงูุจ ุงูุนููู
    โโโ style.css        # ุงูุชูุณูู
```

## ๐ง ุงูุฃูุงูุฑ ุงููุชุงุญุฉ

- `npm run init-db`: ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน ูุณุชุฎุฏููู ุนููุฉ
- `npm run start-vuln`: ุชุดุบูู ุงูุฎุงุฏู ุงูุถุนูู (ุงููููุฐ 1234)
- `npm run start-secure`: ุชุดุบูู ุงูุฎุงุฏู ุงูุขูู (ุงููููุฐ 1235)  
- `npm start`: ุชุดุบูู ุงูุฎุงุฏู ุงูุขูู (ุงูุชุฑุงุถู)

## ๐ฅ ุงููุณุชุฎุฏููู ุงูุนููุฉ

| ุงุณู ุงููุณุชุฎุฏู | ูููุฉ ุงููุฑูุฑ | ุงูุฏูุฑ |
|----------|----------|------|
| admin | adminpass | admin |
| alice | alicepass | user |

## โ๏ธ ููุงุญุธุงุช ุฃูููุฉ

- **ุจูุฆุฉ ุงููุฎุชุจุฑ ููุท**: ุงูุฎุงุฏู ุงูุถุนูู ุถุนูู ุนูุฏุงู
- **ุงูุงุณุชุฎุฏุงู ุงูุฅูุชุงุฌู**: ูุง ุชุณุชุฎุฏู ุฃุจุฏุงู ุฃุณุฑุงุฑ ุถุนููุฉ ุฃู `alg: none` ูู ุงูุฅูุชุงุฌ
- **HTTPS ูุทููุจ**: ุงุณุชุฎุฏู HTTPS ูู ุงูุฅูุชุงุฌ ูุญูุงูุฉ ุงูุฑููุฒ ูู ุงูุนุจูุฑ
- **ุฅุฏุงุฑุฉ ุงูุฃุณุฑุงุฑ**: ูู ุจุชุฏููุฑ ุงูุฃุณุฑุงุฑ ุจุงูุชุธุงู ูู ุงูุฅูุชุงุฌ
- **ุชุฎุฒูู ุงูุฑููุฒ**: ูุถู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท HttpOnly ุนูู localStorage ูุฑููุฒ ุงูุชุญุฏูุซ

## ๐ ุฃูุฏุงู ุงูุชุนูู

ุจุนุฏ ุฅููุงู ูุฐุง ุงููุฎุชุจุฑุ ูุฌุจ ุฃู ุชููู:

1. **ุฃูุถู ููุงุฑุณุงุช ุฃูุงู JWT**
   - ุชูููุฏ ูุฅุฏุงุฑุฉ ุงูุฃุณุฑุงุฑ ุงููููุฉ
   - ุงูุชุญูู ุงูุตุญูุญ ูู ุงููุทุงูุจุงุช (iss, aud, alg)
   - ุฅุฏุงุฑุฉ ุนูุฑ ุงูุฑูุฒ

2. **ุซุบุฑุงุช JWT ุงูุดุงุฆุนุฉ**
   - ูุฌูุงุช ุฎูุท ุงูุฎูุงุฑุฒููุงุช
   - ุงุณุชุบูุงู ุงูุฃุณุฑุงุฑ ุงูุถุนููุฉ
   - ูุฌูุงุช ุณุฑูุฉ ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุฑููุฒ

3. **ุงุณุชุฑุงุชูุฌูุงุช ุฑูุฒ ุงูุชุญุฏูุซ**
   - ุฏูุฑุงู ุงูุฑูุฒ ููุฃูุงู
   - ุชุชุจุน ุงูุฑูุฒ ุนูู ุงูุฎุงุฏู
   - ุญูุงูุฉ ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท HttpOnly

## ๐ฏ ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุงุช

### โ ูุชุงุฆุฌ ุงููุฌูุงุช

**ุงูุฎุงุฏู ุงูุถุนูู (ุงููููุฐ 1234):**
- ูุฌูู ุฎูุงุฑุฒููุฉ None: ูุฌุญ (200 OK)
- ูุฌูู ุงูุณุฑ ุงูุถุนูู: ูุฌุญ (200 OK)

**ุงูุฎุงุฏู ุงูุขูู (ุงููููุฐ 1235):**
- ูุฌูู ุฎูุงุฑุฒููุฉ None: ูุญุฌูุจ (401 Unauthorized)
- ูุฌูู ุงูุณุฑ ุงูุถุนูู: ูุญุฌูุจ (401 Unauthorized)

### ๐ ุงูููุฒุงุช ุงูุฃูููุฉ ุงููุทุจูุฉ

1. โ ุชูููู ุงูุจูุฆุฉ ูุน ููู .env
2. โ ุฅุฒุงูุฉ ุงูุฃุณุฑุงุฑ ุงูุถุนููุฉ ุงููุจุฑูุฌุฉ
3. โ ูุฑุถ ูุทุงูุจุงุช ุงูุฑูุฒ (iss, aud) ูุงูุชุญูู
4. โ ุชูููุฐ ุงุณุชุฑุงุชูุฌูุฉ ุฑูุฒ ุงูุชุญุฏูุซ ูุน ุงูุฏูุฑุงู
5. โ ุงูุญูุงุธ ุนูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุงูููุฌูุฏุฉ ูุน ุชุบููุฑุงุช ุทูููุฉ
6. โ ุนุฑุถ ุงููุฌูุงุช ุนูู ุงูุฎุงุฏู ุงูุถุนูู
7. โ ุฅุธูุงุฑ ูุดู ุงููุฌูุงุช ุนูู ุงูุฎุงุฏู ุงููุญูู
8. โ ุชูุซูู ุชุญููู ุญุฑูุฉ ุงููุฑูุฑ ูุน Wireshark

---

**โ๏ธ ุฅุฎูุงุก ุงููุณุคูููุฉ**: ูุฐุง ุงููุฎุชุจุฑ ููุฃุบุฑุงุถ ุงูุชุนููููุฉ ููุท. ุงูุฎุงุฏู ุงูุถุนูู ูุญุชูู ุนูู ููุฏ ุถุนูู ุนูุฏุงู ููุง ูุฌุจ ุงุณุชุฎุฏุงูู ุฃุจุฏุงู ูู ุจูุฆุงุช ุงูุฅูุชุงุฌ.

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

1. **ุชุดุบูู ุงูุฎูุงุฏู:**
   ```bash
   npm run start-vuln    # ุงููููุฐ 1234 (ุถุนูู)
   npm run start-secure  # ุงููููุฐ 1235 (ุขูู)
   ```

2. **ุงุฎุชุจุงุฑ ุงููุฌูุงุช:**
   ```bash
   node attack-demos.js  # ุชูููุฏ ุฑููุฒ ุงููุฌูู
   node security-demo.js # ุนุฑุถ ุงูููุฎุต ุงููุงูู
   ```

3. **ุงููุตูู ููุชุทุจูู:**
   - ุงูุถุนูู: http://localhost:1234
   - ุงูุขูู: http://localhost:1235

ุงูุฎุงุฏู ุงูุขูู ูุญุฌุจ ุจูุฌุงุญ ุฌููุน ุงููุฌูุงุช ุงููุนุฑูุถุฉ ูุน ุงูุญูุงุธ ุนูู ูุธููุฉ ุงููุตุงุฏูุฉ ุงูุตุญูุญุฉ.